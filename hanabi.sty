\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{hanabi}[2020/04/16 v1.0 A package for drawing Hanabi cards]

% Requirements
\RequirePackage{pgfkeys}
\RequirePackage{pgfopts}
\RequirePackage{scalerel}
\RequirePackage{xstring}

\RequirePackage{tikz}
	\usetikzlibrary{backgrounds,calc,shapes}
	
% Colours
\definecolor{red}{rgb}{1, 0, 0}
\definecolor{yellow}{rgb}{1, 1, 0}
\definecolor{green}{rgb}{0, 1, 0}
\definecolor{blue}{rgb}{0, 0, 1}
\definecolor{purple}{rgb}{0.5, 0, 1}
\definecolor{teal}{rgb}{0, 0.8, 0.8}

\definecolor{aqua}{rgb}{0.5, 1.0, 1.0}
\definecolor{cream}{rgb}{0.9, 0.9, 0.81}

% Symbols
% \newcommand{\red}{\includegraphics[width=10pt, height=10pt]{symbols/red.pdf}}
% \newcommand{\yellow}{\includegraphics[width=10pt, height=10pt]{symbols/yellow.pdf}}
% \newcommand{\green}{\includegraphics[width=10pt, height=10pt]{symbols/green.pdf}}
% \newcommand{\blue}{\includegraphics[width=10pt, height=10pt]{symbols/blue.pdf}}
% \newcommand{\purple}{\includegraphics[width=10pt, height=10pt]{symbols/purple.pdf}}
% \newcommand{\teal}{\includegraphics[width=10pt, height=10pt]{symbols/teal.pdf}}
% \newcommand{\black}{\includegraphics[width=10pt, height=10pt]{symbols/black.pdf}}
% \newcommand{\white}{\includegraphics[width=10pt, height=10pt]{symbols/white.pdf}}
% \newcommand{\rainbow}{\includegraphics[width=10pt, height=10pt]{symbols/rainbow.pdf}}
% \newcommand{\zero}{\includegraphics[width=10pt, height=10pt]{symbols/zero.pdf}}
% \newcommand{\one}{\includegraphics[width=10pt, height=10pt]{symbols/one.pdf}}
% \newcommand{\two}{\includegraphics[width=10pt, height=10pt]{symbols/two.pdf}}
% \newcommand{\three}{\includegraphics[width=10pt, height=10pt]{symbols/three.pdf}}
% \newcommand{\four}{\includegraphics[width=10pt, height=10pt]{symbols/four.pdf}}
% \newcommand{\five}{\includegraphics[width=10pt, height=10pt]{symbols/five.pdf}}
% \newcommand{\blank}{\includegraphics[width=10pt, height=10pt]{symbols/blank.pdf}}

\newcommand{\red}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{red.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}
	
\newcommand{\yellow}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{yellow.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\green}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{green.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\blue}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{blue.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}
	
\newcommand{\purple}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{purple.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\teal}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{teal.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\black}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{black.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}
	
\newcommand{\white}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{white.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}%

\newcommand{\rainbow}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{rainbow.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}
	
\newcommand{\zero}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{zero.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\one}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{one.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\two}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{two.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\three}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{three.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\four}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{four.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\five}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{five.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\newcommand{\blank}{\scalerel*{%
	\def\svgwidth{10 pt}%
	\import{symbols/}{blank.pdf_tex} }{X\rule[0ex]{0pt}{1pt}}%
}

\pgfkeys{/card/options/.is family}
\newcommand{\cardsetup}[1]{\pgfkeys{/card/options, #1}}

\pgfkeys{/card/options,
	color/.default = X,
	color/.is choice,
	color/X/.code = {%
		\def \csymbol {\!}},
	color/R/.code = {%
		\def \csymbol {\red}},
	color/Y/.code = {%
		\def \csymbol {\yellow}},
	color/G/.code = {%
		\def \csymbol {\green}},
	color/B/.code = {%
		\def \csymbol {\blue}},
	color/P/.code = {%
		\def \csymbol {\purple}},
	color/T/.code = {%
		\def \csymbol {\teal}},
	color/K/.code = {%
		\def \csymbol {\black}},
	color/W/.code = {%
		\def \csymbol {\white}},
	color/M/.code = {%
		\def \csymbol {\rainbow}},
	}

\pgfkeys{/card/options,
	number/.default = X,
	number/.is choice,
	number/X/.code = {%
		\def \nsymbol {\!}},
	number/0/.code = {%
		\def \nsymbol {\zero}},
	number/1/.code = {%
		\def \nsymbol {\one}},
	number/2/.code = {%
		\def \nsymbol {\two}},
	number/3/.code = {%
		\def \nsymbol {\three}},
	number/4/.code = {%
		\def \nsymbol {\four}},
	number/5/.code = {%
		\def \nsymbol {\five}},
	}

\pgfkeys{/card/options,	
	colorclue/.default = false,
	colorclue/.is choice,
	colorclue/true/.code = {%
		\def \cclue {(0.10, 0.35) node {\tiny \hspace{-1.5 mm} \csymbol}}%
		\def \bordercolor {orange}%
	},
	colorclue/false/.code = {%
		\def \cclue {(0.10, 0.35) node {\tiny \hspace{-2 mm} \blank}}%
		\def \bordercolor {black}%
	},
	numberclue/.default = false,
	numberclue/.is choice,
	numberclue/true/.code = {%
		\def \nclue {(-0.02, 0.35) node {\tiny \hspace{-2 mm} \nsymbol}}%
		\def \bordercolor {orange}%
	},
	numberclue/false/.code = {%
		\def \nclue {(-0.02, 0.35) node {\tiny \hspace{-2 mm} \blank}}%
		\def \bordercolor {black}%
	},	
	finessed/.default = false,
	finessed/.is choice,
	finessed/true/.code = {%
		\def \bordercolor {aqua}%
	},
	finessed/false/.code = {},
	chopmoved/.default = false,
	chopmoved/.is choice,
	chopmoved/true/.code = {%
		\def \bordercolor {cream}%
	},
	chopmoved/false/.code = {},
	c/.value forbidden,
	c/.style = {colorclue = true},
	n/.value forbidden,
	n/.style = {numberclue = true},
	cn/.value forbidden,
	cn/.style = {colorclue = true, numberclue = true},
	nc/.value forbidden,
	nc/.style = {colorclue = true, numberclue = true},	
	f/.value forbidden,
	f/.style = {finessed = true},
	cm/.value forbidden,
	cm/.style = {chopmoved = true},
}

\newcommand{\CARD}[2][]{%
	\raisebox{-2 pt}{%
		\begin{tikzpicture}
			\StrLeft{#2}{1}[\@@color]
			\StrRight{#2}{1}[\@@number]
			\cardsetup{#1, color=\@@color, number=\@@number}
			\draw[\bordercolor, line width = 0.9 pt] (-0.36, -0.24) rectangle (0.36, 0.24)
			(0,0) node {\nsymbol \! \csymbol}
			\cclue \nclue;
			\carddefault
		\end{tikzpicture}%
	}%
}

\newcommand{\C}[1]{%
	\StrLeft{#1}{1}[\@@color]%
	\StrRight{#1}{1}[\@@number]%
	\cardsetup{color=\@@color, number=\@@number}%
	\nsymbol\,\csymbol%
	\carddefault%
}

\newcommand{\carddefault}{%
	\cardsetup{color, number, colorclue, numberclue, finessed, chopmoved}%
	}%
\carddefault
\ProcessPgfPackageOptions{/card/options}

\endinput